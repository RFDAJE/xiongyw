<html><head><title>Title</title>
<style>

table {border-collapse:collapse;}
table tr:nth-child(odd)	 {background-color:#F2F2F2;}
table tr:nth-child(even) {background-color:#ffffff;}
table th{
	color:#ffffff;background-color:#555555;border:1px solid #555555;font-size:12px;padding:3px;vertical-align:top;text-align:left;
}
table td{
	border:1px solid #d4d4d4;padding:3px;padding-top:3px;padding-bottom:3px;vertical-align:top;
}

table th a:link,table th a:visited {color:#ffffff;}
table th a:hover,table th a:active {color:#dddd33;}


</style>

</head><body> 
<pre><b>Folder: /xxx/yyy/</b><br>

<script language='javascript'>

// two dimensional array
var ENTRIES = [
{type: 'd', name: '.', size: -1, time: '2013-02-01 16:54', href: 'xxx/.'},
{type: '-', name: 'avaricious', size: 68, time: '2013-02-01 16:54', href: 'xxxolocate'},
{type: 'd', name: '..', size: -1, time: '2013-02-01 16:55', href: 'xxx'},
{type: '-', name: 'dictum', size: 6268, time: '2013-02-01 16:54', href: 'xxx'},
{type: '-', name: 'anaerobic', size: 273, time: '2013-02-01 16:54', href: 'xxx'},
{type: '-', name: 'metabolism', size: 755, time: '2013-02-01 16:54', href: 'xxx'},
{type: 'd', name: 'pedal', size: 76, time: '2013-02-01 16:54', href: 'xxx'},
{type: '-', name: 'crank', size: 87, time: '2013-02-01 16:54', href: 'xxx'},
{type: '-', name: 'spoke', size: 86, time: '2013-02-01 16:54', href: 'xxxx'},
{type: '-', name: 'freehub', size: 320, time: '2013-02-01 16:54', href: 'xxx'}];

function get_element(id){
	return document.all? document.all[id] : document.getElementById(id);
}
function hide_n_show(to_hide, to_show){
	get_element(to_hide).style.display = "none";
	get_element(to_show).style.display = "block";
}

// col: column name, string
// is_asc: boolean
function sort_by_column(col, is_asc){
	return function (a,b){
 		  var x = a[col];
		  var y = b[col];
                  var ord = 0;
                  if(x > y) ord = is_asc? 1 : - 1;
                  if(x < y) ord = is_asc? - 1 : 1;
                  return ord;
	        }
}

function size_with_comma(size){
	if(size < 0) return "-"
	var s = "" + size;
	var result = ""
	var mod = s.length % 3;
	var n = parseInt((s.length - 1) / 3);
	if(mod == 0) mod = 3
	if(mod) result += s.substring(0, mod);
	for(var i = 0; i < n; i ++){
		result += "," + s.substring(mod + i * 3, mod + i * 3 + 3);
	}
	return result;
}

// col: column name, one of "type"/"name"/"size"/"time"
// asc: true/false, ascending? 
function render_table_header(col, asc){
	var cur_div = "d_" + col + (asc? "_a" : "_d");
	var docW = "";
	docW += "<tr>";
	docW += "<th><a href='javascript: hide_n_show(\"" + cur_div + "\", \"d_type_" + (((col == "type") && asc)? "d\"" : "a\"") + ")'>Type</a>&nbsp;" + ((col == "type")?(asc? "&uarr;" : "&darr;") : "&nbsp;") + "</th>";
	docW += "<th><a href='javascript: hide_n_show(\"" + cur_div + "\", \"d_name_" + (((col == "name") && asc)? "d\"" : "a\"") + ")'>Name</a>&nbsp;" + ((col == "name")?(asc? "&uarr;" : "&darr;") : "&nbsp;") + "</th>";
	docW += "<th><a href='javascript: hide_n_show(\"" + cur_div + "\", \"d_size_" + (((col == "size") && asc)? "d\"" : "a\"") + ")'>Size</a>&nbsp;" + ((col == "size")?(asc? "&uarr;" : "&darr;") : "&nbsp;") + "</th>";
	docW += "<th><a href='javascript: hide_n_show(\"" + cur_div + "\", \"d_time_" + (((col == "time") && asc)? "d\"" : "a\"") + ")'>Modified</a>&nbsp;" + ((col == "time")?(asc? "&uarr;" : "&darr;") : "&nbsp;") + "</th>";
	return docW;
}

function render_table_row(i){
	if(ENTRIES[i].type === 'd')  // bold directories
		return "<tr><td>" + ENTRIES[i].type + "</td><td><b><a href='" + ENTRIES[i].href + "'>" + ENTRIES[i].name + "</a></b></td><td align=right>" + size_with_comma(ENTRIES[i].size) + "</td><td>" + ENTRIES[i].time + "</td>";
	else
		return "<tr><td>" + ENTRIES[i].type + "</td><td>   <a href='" + ENTRIES[i].href + "'>" + ENTRIES[i].name + "</a>    </td><td align=right>" + size_with_comma(ENTRIES[i].size) + "</td><td>" + ENTRIES[i].time + "</td>";
}



var i;


// remove the '.' directory, if exist
/*
for(i = 0; i < ENTRIES.length; i ++){
	if(ENTRIES[i].name === '.'){
		ENTRIES.splice(i, 1);
		break;
	}
}

// prefix '/' before directores
for(i = 0; i < ENTRIES.length; i ++){
	if(ENTRIES[i].type === 'd'){
		ENTRIES[i].name = '/' + ENTRIES[i].name;
	}
}
*/

// filter the '.' entry and prefix '/' before directories
ENTRIES = ENTRIES.filter(function(x){return x.name != '.'}).map(function(x){if(x.type === 'd') x.name = '/' + x.name; return x});


// keep '..' always at the top line
Array.prototype.sort2 = function(cmp){

               var dotdot =  this.filter(function(x){return x.name === '/..';});
               var rest = this.filter(function(x){return x.name != '/..';});

               rest.sort(cmp);
               this.length = 0;
               if(dotdot.length != 0){   
                   this.push(dotdot[0]); 
               }

               for(var i = 0; i < rest.length; i ++)   this.push(rest[i]);

               return this;
}



////////////////////////////////////////////////////////////////////////
ENTRIES.sort2(sort_by_column("type", true));
document.write("<div id='d_type_a' style='display:none'><table>");
document.write(render_table_header("type", true));
for(i = 0; i < ENTRIES.length; i ++) document.write(render_table_row(i));  // use reduce() instead!
document.write("</table></div>");

ENTRIES.sort2(sort_by_column("type", false));
document.write("<div id='d_type_d' style='display:none'><table>");
document.write(render_table_header("type", false));
//for(i = ENTRIES.length - 1; i >= 0; i --) document.write(render_table_row(i));
for(i = 0; i < ENTRIES.length; i ++) document.write(render_table_row(i));
document.write("</table></div>");

////////////////////////////////////////////////////////////////////////
ENTRIES.sort2(sort_by_column("name", true));
document.write("<div id='d_name_a' style='display:none'><table>");
document.write(render_table_header("name", true));
for(i = 0; i < ENTRIES.length; i ++) document.write(render_table_row(i));
document.write("</table></div>");


ENTRIES.sort2(sort_by_column("name", false));
document.write("<div id='d_name_d' style='display:none'><table>");
document.write(render_table_header("name", false));
//for(i = ENTRIES.length - 1; i >= 0; i --) document.write(render_table_row(i));
for(i = 0; i < ENTRIES.length; i ++) document.write(render_table_row(i));
document.write("</table></div>");



////////////////////////////////////////////////////////////////////////
ENTRIES.sort2(sort_by_column("size", true));
document.write("<div id='d_size_a' style='display:none'><table>");
document.write(render_table_header("size", true));
for(i = 0; i < ENTRIES.length; i ++) document.write(render_table_row(i));
document.write("</table></div>");


ENTRIES.sort2(sort_by_column("size", false));
document.write("<div id='d_size_d' style='display:none'><table>");
document.write(render_table_header("size", false));
//for(i = ENTRIES.length - 1; i >= 0; i --) document.write(render_table_row(i));
for(i = 0; i < ENTRIES.length; i ++) document.write(render_table_row(i));
document.write("</table></div>");


////////////////////////////////////////////////////////////////////////
ENTRIES.sort2(sort_by_column("time", true));
document.write("<div id='d_time_a' style='display:none'><table>");
document.write(render_table_header("time", true));
for(i = 0; i < ENTRIES.length; i ++) document.write(render_table_row(i));
document.write("</table></div>");

ENTRIES.sort2(sort_by_column("time", false));
document.write("<div id='d_time_d' style='display:none'><table>");
document.write(render_table_header("time", false));
//for(i = ENTRIES.length - 1; i >= 0; i --) document.write(render_table_row(i));
for(i = 0; i < ENTRIES.length; i ++) document.write(render_table_row(i));
document.write("</table></div>");

// show one div 
get_element("d_type_d").style.display = "block";

</script>
<br><hr><address>Powered by <a href='http://tstool.sourceforge.net/drops/uhttpd-0.0.2.tar.gz'>uhttpd v0.0.2</a>, &copy;&nbsp;2002-2004&nbsp;<a href='mailto:xiongyw@hotmail.com'>Yuwu (Bruin) Xiong</a></address></body></html>
