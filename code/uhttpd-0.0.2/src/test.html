<html><head><title>Title</title>
<style>

table {border-collapse:collapse;}
table tr:nth-child(odd)	 {background-color:#F2F2F2;}
table tr:nth-child(even) {background-color:#ffffff;}
table th{
	color:#ffffff;background-color:#555555;border:1px solid #555555;font-size:12px;padding:3px;vertical-align:top;text-align:left;
}
table td{
	border:1px solid #d4d4d4;padding:3px;padding-top:3px;padding-bottom:3px;vertical-align:top;
}

table th a:link,table th a:visited {color:#ffffff;}
table th a:hover,table th a:active {color:#dddd33;}

</style></head><body> 

<pre><b>Folder: /xxx/yyy/</b><br>

<script language='javascript'>

// two dimensional array
var ENTRIES = [
{type: 'd', name: '.', size: -1, time: '2013-02-01 16:54', href: 'xxx/.'},
{type: '-', name: 'avaricious', size: 68, time: '2013-02-01 16:54', href: 'xxxolocate'},
{type: 'd', name: '..', size: -1, time: '2013-02-01 16:55', href: 'xxx'},
{type: '-', name: 'dictum', size: 6268, time: '2013-03-01 16:54', href: 'xxx'},
{type: '-', name: 'anaerobic', size: 273, time: '2013-04-01 16:54', href: 'xxx'},
{type: '-', name: 'metabolism', size: 755, time: '2013-05-01 16:54', href: 'xxx'},
{type: 'd', name: 'pedal', size: 76, time: '2013-06-01 16:54', href: 'xxx'},
{type: '-', name: 'crank', size: 87, time: '2013-07-01 16:54', href: 'xxx'},
{type: '-', name: 'spoke', size: 86, time: '2013-08-01 16:54', href: 'xxxx'},
{type: '-', name: 'freehub', size: 320, time: '2013-12-01 16:54', href: 'xxx'}];


/**
* hide and show DIV elements
*
* @param {String} to_hide, the id of DIV to hide
* @param {String} to_show, the id of DIV to show
* @return none
*/
function hide_n_show(to_hide, to_show){
    document.getElementById(to_hide).style.display = "none";
    document.getElementById(to_show).style.display = "block";
}

/** 
* return a compare function for sort()
*
* @param {String} col: the name of the column to sort by
* @param {Boolean} ascending: ascending (true) or descending (false)
* @return {Function} The compare function for Array.prototype.sort()
*/
function sort_by_column(col, ascending){
    return function (a,b){
        var ord = 0;
        if(a[col] > b[col]) ord = ascending? 1 : - 1;
        if(a[col] < b[col]) ord = ascending? - 1 : 1;
        return ord;
    }
}

/**
* convert a number into string seperated by commas
*
* @param {Number} size: the size
* @return {String} a converted string
*/
function size_with_comma(size){
    if(size < 0) return "-"
    var s = "" + size;
    var result = ""
    var mod = s.length % 3;
    var n = parseInt((s.length - 1) / 3);
    if(mod == 0) mod = 3
    if(mod) result += s.substring(0, mod);
    for(var i = 0; i < n; i ++){
	result += "," + s.substring(mod + i * 3, mod + i * 3 + 3);
    }
    return result;
}

/**
* return a table header
*
* @param {String} col: the name of the column by which the table is sorted
* @param {Boolean} ascending: ascending (true) or descending (false)
* @return {String} string to be added to the document
*/
function render_table_header(col, asc){
    var header = ["type", "name", "size", "time"];
    var cur_div = "d_" + col + (asc? "_a" : "_d");
    var th = function(column){
        return "<th><a href='javascript: hide_n_show(\"" + 
               cur_div + "\", \"d_" + column +"_" + (((col == column) && asc)? 
               "d\"" : "a\"") + ")'>"+column.toUpperCase()+"</a>&nbsp;" + 
               ((col == column)?(asc? "&uarr;" : "&darr;") : "&nbsp;") + "</th>";
    }

    var docW = "<tr>";
    docW += header.map(th).join(" ");
    
    return docW;
}

/**
* return  a row
*
* @param {Object} x: an entry in the array
* @return {String} the string to be written to the document
*/
function render_a_row(x){
    var b = (x.type === 'd');  // put text for directories <bold>
    return "<tr><td>" + x.type + "</td><td>" + (b? "<b>":"") + "<a href='" + x.href + "'>" + x.name + "</a>" + (b? "</b>":"") + "</td><td align=right>" + size_with_comma(x.size) + "</td><td>" + x.time + "</td>";
}

// filter the '.' entry and prefix '/' before directories
ENTRIES = ENTRIES.filter(function(x){return x.name != '.'}).map(function(x){if(x.type === 'd') x.name = '/' + x.name; return x});

/*
* sort2() keeps the '/..' folder at the top
*
*@param {Function} cmp: a compare function required by sort()
*@return {Array} the array is sorted in place
*/
ENTRIES.sort2 = function (cmp){

     var dotdot =  this.filter(function(x){return x.name === '/..';});
     var rest = this.filter(function(x){return x.name != '/..';}).sort(cmp);

     this.length = 0; // empty the array

     if(dotdot.length != 0){   
         this.push(dotdot[0]); 
     }

     for(var i = 0; i < rest.length; i ++){
         this.push(rest[i]);
     }

     return this;
}

/** 
* write a div to the document
* 
* @param {String} column: the name of the column by which the table is sorted
* @param {Boolean} is_asc: ascending (true) or descending (false)
* @param {String} id: the DIV element id
* @return: none
*/
function write_div(column, is_asc, id){
    ENTRIES.sort2(sort_by_column(column, is_asc));
    document.write("<div id='"+ id +"' style='display:none'><table>");
    document.write(render_table_header(column, is_asc));
    document.write(ENTRIES.map(render_a_row).join(" "));
    document.write("</table></div>");
}


// now write DIVs
write_div("type", true,  "d_type_a");
write_div("type", false, "d_type_d");

write_div("name", true,  "d_name_a");
write_div("name", false, "d_name_d");

write_div("size", true,  "d_size_a");
write_div("size", false, "d_size_d");

write_div("time", true,  "d_time_a");
write_div("time", false, "d_time_d");

// show the default DIV 
document.getElementById("d_type_d").style.display = "block";

</script>
<br><hr>
<address>Powered by <a href='http://tstool.sourceforge.net/drops/uhttpd-0.0.2.tar.gz'>uhttpd v0.0.2</a>, &copy;&nbsp;2002-2004&nbsp;<a href='mailto:xiongyw@hotmail.com'>Yuwu (Bruin) Xiong</a></address>
</body>
</html>
