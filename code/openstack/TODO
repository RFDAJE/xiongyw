- haproxy: timeout setting in config
- network teaming: mode, and disable NetworkManager
- rabbitmq:
  . bind address for 5672: done, via /etc/rabbitmq/rabbitmq-env.conf
  . bind address for 15672: done, via /etc/rabbitmq/rabbitmq.conf
  . haproxy for mq and its web ui: done
  . test crash/reboot cases
  . persistency: cluster status; user/permission; policy persistency
- mongod: web ui; replica set details; mongo shell; access control
- haproxy on host
- stonith
- config keystone to use MQ for sending notification (to be captured by ceilometer).

issues:
------
+ openstack service list:
  - symptom: The request you have made requires authentication. (HTTP 401) (Request-ID: req-cd63c85b-41f0-4345-ab84-bd9e9eea2c8b)
  - resolved: url should be idential to registered url (at bootstrap).

+ ceilometer-api: 0
  - symptom: haproxy webui shows backends failure
  - resolved: don't add "option httpchk". <http://docs.openstack.org/ha-guide/controller-ha-haproxy.html#configuring-haproxy>
+ ceilometer-api: 1
  - symptom: "ceilometer meter-list" return 500 internal server error.
    trace in "/var/httpd/ceilometer_error.log": cannot register CLI option
  - change uri to url in ceilometer.conf [service_credentials], error changes to:
    Service Unavailable (HTTP 503) (Request-ID: req-0a15ba7b-9203-4923-872a-41c89ef7cb48)
  - if remove authtoken middleware from pipeline (defined in api_paste.ini), the issue is gone.
      so the problem is at keystone configuration.
  - resolved: a typo in [keystone_authtoken] section: username, not user_name!
+ ceilometer-api: 2
  - symptom: /var/log/ceilometer/api-wsgi.log: INFO ceilometer.api.controllers.v2.utils [-] No limit value provided, result set will be limited to 100.
  - explanation: in [api] section of ceilometer.conf: #default_api_return_limit = 100
+ ceilometer-api: 3
  - symptom: "ceilometer event-list/event-type-list" returns "Internal Server error (http 500)"
  - log: /var/log/httpd/ceilometer_error.log
    mod_wsgi (pid=14970): Exception occurred processing WSGI script '/usr/lib/python2.7/site-packages/ceilometer/api/app.wsgi'.
    Traceback (most recent call last):
    ...
    File "/usr/lib/python2.7/site-packages/ceilometer/api/controllers/v2/root.py", line 178, in panko_url
      keystone_client.get_client())
    File "/usr/lib/python2.7/site-packages/ceilometer/keystone_client.py", line 41, in get_service_catalog
      return client.session.auth.get_access(client.session).service_catalog
    AttributeError: 'NoneType' object has no attribute 'get_access'
  - guess: keystone_client.get_client() return None, in panko_url().
  - 
+ ceilometer-api: 4
  - symptom: "ceilometer alarm-list" returns "Internal Server error (http 500)"

+ ceilometer-api: 5
  - one 'sample-create' command ends up with 2 records in mongodb:
    $ ceilometer sample-create -r 37128ad6-daaa-4d22-9509-b7e1c6b08697 -m my-meter-name --meter-type gauge --meter-unit MB --sample-volume 48
    db.getCollection('meter').find({counter_name:"my-meter-name"})
  - hint:
  - reason:
  
+ ceilometer-central: 1
  - symptom: /var/log/ceilometer/central.log:
    2017-02-14 15:29:11.598 20122 ERROR ceilometer.agent.manager [-] Skipping tenant, keystone issue: An auth plugin is required to determine endpoint URL
    2017-02-14 15:29:11.600 20122 ERROR ceilometer.agent.manager [-] Skipping images, keystone issue: An auth plugin is required to determine endpoint URL
  - hint: ceilometer/agent/manager.py:507, ka_exceptions.ClientException
  - resolved:
+ ceilometer-central: 2
  - symptom: /var/log/ceilometer/central.log:
    2017-02-22 18:57:26.738 20565 ERROR ceilometer.agent.manager [-] Unable to discover resources: 'NoneType' object has no attribute 'get_access'
    2017-02-22 18:57:26.738 20565 ERROR ceilometer.agent.manager Traceback (most recent call last):
    2017-02-22 18:57:26.738 20565 ERROR ceilometer.agent.manager   File "/usr/lib/python2.7/site-packages/ceilometer/agent/manager.py", line 491, in discover
    2017-02-22 18:57:26.738 20565 ERROR ceilometer.agent.manager     self.keystone).get_endpoints(
    2017-02-22 18:57:26.738 20565 ERROR ceilometer.agent.manager   File "/usr/lib/python2.7/site-packages/ceilometer/keystone_client.py", line 41, in get_service_catalog
    2017-02-22 18:57:26.738 20565 ERROR ceilometer.agent.manager     return client.session.auth.get_access(client.session).service_catalog
    2017-02-22 18:57:26.738 20565 ERROR ceilometer.agent.manager AttributeError: 'NoneType' object has no attribute 'get_access'
  - resolution:
+ ceilometer-central: 3
  - symptotm: /var/log/ceilometer/central.log:
    2017-02-22 18:57:26.814 20565 WARNING stevedore.named [-] Could not load snmp
    2017-02-22 18:57:26.815 20565 WARNING ceilometer.agent.manager [-] Continue after error from switch.port.receive.packets: No 'network.statistics.drivers' driver found, looking for 'snmp'
  - resolution:
  - reference: http://www.cnblogs.com/linyihan/p/5804745.html

+ ceilometer-ipmi: 1
  - symptom: a log of error msgs in /var/log/ceilometer/agent-ipmi.log:
    ERROR cotyledon EmptyPollstersList: No valid pollsters can be loaded with the startup parameters polling-namespaces and pollster-list.
    ERROR ceilometer.agent.manager ExtensionLoadError: [Errno 2] No such file or directory
  - hints: http://superuser.openstack.org/articles/ceilometer-full-stack-monitoring-for-openstack/
    it's moved into ironic code base? To collect IPMI data OpenStack deployments require the Ironic Conductor. It will push IPMI monitoring data to Ceilometer on the notification bus. This data is not in the format that Ceilometer requires. The Ceilometer notification handler intercepts this data and stores it in the Ceilometer Storage DB. The Ceilometer IPMI Inspector periodically checks the Ceilometer Storage DB and converts the format from the Ironic message format to the Ceilometer format.
        
+ ceilometer-collector
  - symptom: /var/log/ceilometer/collector.log:
    WARNING ceilometer.dispatcher [-] Failed to load any dispatchers for ceilometer.dispatcher.event
  - related bug report: https://bugs.launchpad.net/oslo.config/+bug/1587315
  - [DEFAULT] section in ceilometer.conf: #meter_dispatchers = database, #event_dispatchers =

+ aodh:
  - question: does aodh depends on gnocchi?

+ aodh-notifier:
  - symptom: in /var/log/aodh/notifier.log:
    ERROR oslo.messaging._drivers.impl_rabbit [-] [ee4d8c81-08df-4e66-85f0-deb485c0e937] AMQP server on c2m:5672 is unreachable: [Errno 111] Connection refused. Trying again in 1 seconds. Client port: None
    ...
    ERROR cotyledon AccessRefused: (0, 0): (403) ACCESS_REFUSED - Login was refused using authentication mechanism AMQPLAIN.
  - identified and resolved: this is the rabbitmq issue. after fixing rabbitmq, the issue is gone.

+ rabbitmq:
  - after reboot, only one of the node is up running, and the cluster only has 1 node, although 'pcs status' shows that it's ok.
  - resolution: part of rabbitmq config todo tasks
